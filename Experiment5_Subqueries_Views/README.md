# Experiment 5: Subqueries and Views

## AIM
To study and implement subqueries and views.

## THEORY

### Subqueries
A subquery is a query inside another SQL query and is embedded in:
- WHERE clause
- HAVING clause
- FROM clause

**Types:**
- **Single-row subquery**:
  Sub queries can also return more than one value. Such results should be made use along with the operators in and any.
- **Multiple-row subquery**:
  Here more than one subquery is used. These multiple sub queries are combined by means of ‘and’ & ‘or’ keywords.
- **Correlated subquery**:
  A subquery is evaluated once for the entire parent statement whereas a correlated Sub query is evaluated once per row processed by the parent statement.

**Example:**
```sql
SELECT * FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```
### Views
A view is a virtual table based on the result of an SQL SELECT query.
**Create View:**
```sql
CREATE VIEW view_name AS
SELECT column1, column2 FROM table_name WHERE condition;
```
**Drop View:**
```sql
DROP VIEW view_name;
```

**Question 1**
--
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose AGE is LESS than $30-- Paste Question 1 here

```
SELECT * FROM CUSTOMERS
WHERE AGE<30;
```

**Output:**

<img width="1216" height="522" alt="image" src="https://github.com/user-attachments/assets/387d2766-93b5-4b01-83c1-8fed78a1359c" />


**Question 2**
---
From the following tables write a SQL query to find all orders generated by London-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

```
SELECT o.ord_no,o.purch_amt,o.ord_date,o.customer_id,o.salesman_id
FROM orders o
JOIN salesman s ON o.salesman_id = s.salesman_id
WHERE s.city = 'London';
```

**Output:**

<img width="1221" height="355" alt="image" src="https://github.com/user-attachments/assets/323634d7-64a4-46fe-823e-da0d8d60783b" />


**Question 3**
---
Write a SQL query to Retrieve the medications with dosages equal to the lowest dosage

Table Name: Medications (attributes: medication_id, medication_name, dosage)

```
SELECT medication_id AS medic,medication_name,dosage
FROM Medications
WHERE dosage = (SELECT MIN(dosage) FROM Medications);
```

**Output:**

<img width="888" height="336" alt="image" src="https://github.com/user-attachments/assets/0c67d83b-2c97-48fd-ae21-67e60dac5e9a" />


**Question 4**
---
Write a SQL query that retrieves the names of students and their corresponding grades, where the grade is equal to the maximum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

```
SELECT g.student_name,g.grade
FROM GRADES g
WHERE grade=(SELECT MAX(grade) FROM GRADES WHERE subject=g.subject);
```

**Output:**

<img width="728" height="369" alt="image" src="https://github.com/user-attachments/assets/029c2117-7da8-4d17-a078-8fb5db3bf40f" />


**Question 5**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose Address as Delhi

Sample table: CUSTOMERS

```
SELECT * FROM CUSTOMERS
WHERE ADDRESS='Delhi';
```

**Output:**

<img width="1186" height="277" alt="image" src="https://github.com/user-attachments/assets/c352a7fc-4ee6-444f-940c-4c13b2bc9c70" />


**Question 6**
---

Write a SQL query to Find employees who have an age less than the average age of employees with incomes over 2.5 Lakh

```
SELECT * FROM Employee
WHERE age<(SELECT AVG(age) FROM Employee WHERE income>250000);
```

**Output:**

<img width="1232" height="441" alt="image" src="https://github.com/user-attachments/assets/b24dd86a-5e40-4229-900c-e6e78dcc3b64" />


**Question 7**
---

Write a SQL query that retrieves the all the columns from the Table Grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

```
SELECT * FROM GRADES g
WHERE grade=(SELECT MIN(grade) FROM GRADES WHERE subject=g.subject);
```

**Output:**


<img width="1234" height="362" alt="image" src="https://github.com/user-attachments/assets/814723ae-3d5e-4378-a12b-c8a4e12fab24" />


**Question 8**
---
Write a SQL query that retrieves the names of students and their corresponding grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

```
SELECT g.student_name,g.grade FROM GRADES g
WHERE grade=(SELECT MIN(grade) FROM GRADES WHERE subject=g.subject);
```

**Output:**

<img width="720" height="366" alt="image" src="https://github.com/user-attachments/assets/4446402e-c548-4b60-a434-f460ae696b50" />


**Question 9**
---

From the following tables write a SQL query to find the order values greater than the average order value of 10th October 2012. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

Note: date should be yyyy-mm-dd format

```
SELECT * FROM ORDERS
WHERE purch_amt>(SELECT AVG(purch_amt) FROM ORDERS WHERE ord_date='2012-10-10');
```

**Output:**

<img width="1228" height="397" alt="image" src="https://github.com/user-attachments/assets/f79e4b26-4066-4c54-8cf2-7f303effdbee" />


**Question 10**
---

From the following tables, write a SQL query to find all orders generated by the salespeople who may work for customers whose id is 3007. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

```
SELECT ord_no,purch_amt,ord_date,customer_id,salesman_id
FROM orders
WHERE salesman_id IN (SELECT salesman_id FROM orders WHERE customer_id=3007);
```

**Output:**

<img width="1225" height="367" alt="image" src="https://github.com/user-attachments/assets/74909771-17fb-4561-b80b-175afa233f91" />



## RESULT
Thus, the SQL queries to implement subqueries and views have been executed successfully.

### Module 4 Grade:

<img width="1052" height="76" alt="image" src="https://github.com/user-attachments/assets/1051b2c0-ce2d-4397-b0a3-0b5b98af087c" />

